open Base

type t =
  | OPEN_CURLY
  | CLOSE_CURLY
  | OPEN_ROUND
  | CLOSE_ROUND
  | SEMICOLON
  | KEYWORD_INT
  | KEYWORD_RETURN
  | IDENTIFIER of string
  | INT_LITERAL of int  
  | NEGATION
  | LOGICAL_NEGATION
  | COMPLEMENT
  | ADDITION
  | MULTIPLICATION
  | DIVISION
  | LOGICAL_AND
  | LOGICAL_OR
  | EQUAL
  | NOT_EQUAL
  | LESS_THAN
  | LESS_THAN_OR_EQUAL
  | GREATER_THAN
  | GREATER_THAN_OR_EQUAL
  | ASSIGNMENT

let print_token = function
| OPEN_CURLY -> "<OPEN_CURLY>"
| CLOSE_CURLY -> "<CLOSE_CURLY>"
| OPEN_ROUND -> "<OPEN_ROUND>"
| CLOSE_ROUND -> "<CLOSE_ROUND>"
| SEMICOLON -> "<SEMICOLON>"
| KEYWORD_INT -> "<KEYWORD_INT>"
| KEYWORD_RETURN -> "<KEYWORD_RETURN>"
| IDENTIFIER s -> Printf.sprintf "<IDENTIFIER: %s>" s
| INT_LITERAL n -> Printf.sprintf "<INT_LITERAL: %d>" n
| NEGATION -> "<NEGATION>"
| LOGICAL_NEGATION -> "<LOGICAL_NEGATION>"
| COMPLEMENT -> "<COMPLEMENT>"
| ADDITION -> "<ADDITION>"
| MULTIPLICATION -> "<MULTIPLICATION>"
| DIVISION -> "<DIVISION>"
| LOGICAL_AND -> "<LOGICAL_AND>"
| LOGICAL_OR -> "<LOGICAL_OR>"
| EQUAL -> "<EQUAL>"
| NOT_EQUAL -> "<NOT_EQUAL>"
| LESS_THAN -> "<LESS_THAN>"
| LESS_THAN_OR_EQUAL -> "<LESS_THAN_OR_EQUAL>"
| GREATER_THAN -> "<GREATER_THAN>"
| GREATER_THAN_OR_EQUAL -> "<GREATER_THAN_OR_EQUAL>"
| ASSIGNMENT -> "<ASSIGNMENT>"
  
let eq (t1: t) (t2: t) = match t1, t2 with
| OPEN_CURLY, OPEN_CURLY -> true
| CLOSE_CURLY, CLOSE_CURLY -> true
| OPEN_ROUND, OPEN_ROUND -> true
| CLOSE_ROUND, CLOSE_ROUND -> true
| SEMICOLON, SEMICOLON -> true
| KEYWORD_INT, KEYWORD_INT -> true
| KEYWORD_RETURN, KEYWORD_RETURN -> true
| IDENTIFIER s1, IDENTIFIER s2 -> String.(s1 = s2)
| INT_LITERAL n1, INT_LITERAL n2 -> Int.(n1 = n2)
| NEGATION, NEGATION -> true
| LOGICAL_NEGATION, LOGICAL_NEGATION -> true
| COMPLEMENT, COMPLEMENT -> true
| ADDITION, ADDITION -> true
| MULTIPLICATION, MULTIPLICATION -> true
| LOGICAL_AND, LOGICAL_AND -> true
| LOGICAL_OR, LOGICAL_OR -> true
| EQUAL, EQUAL -> true
| NOT_EQUAL, NOT_EQUAL -> true
| LESS_THAN, LESS_THAN -> true
| LESS_THAN_OR_EQUAL, LESS_THAN_OR_EQUAL -> true
| GREATER_THAN, GREATER_THAN -> true
| GREATER_THAN_OR_EQUAL, GREATER_THAN_OR_EQUAL -> true
| ASSIGNMENT, ASSIGNMENT -> true
| _ -> false

let is_unary_op = function
| NEGATION | LOGICAL_NEGATION | COMPLEMENT -> true
| _ -> false
